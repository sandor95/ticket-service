USE CORE_DEV;

CREATE TABLE USER
(
    ID    INT(10)      NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NAME  VARCHAR(200) NOT NULL,
    EMAIL VARCHAR(200) NOT NULL UNIQUE,
    INDEX IDX_ID (ID),
    INDEX IDX_NAME_EMAIL (NAME, EMAIL)
);

CREATE TABLE DEVICE
(
    ID          INT(10)    NOT NULL AUTO_INCREMENT PRIMARY KEY,
    USER_ID     INT(10)    NOT NULL,
    DEVICE_HASH MEDIUMTEXT NOT NULL
);

CREATE TABLE TOKEN
(
    ID      INT(10)    NOT NULL AUTO_INCREMENT PRIMARY KEY,
    USER_ID INT(10)    NOT NULL,
    TOKEN   MEDIUMTEXT NOT NULL -- can this be UNIQUE? it seems it could
);

CREATE TABLE BANK_CARD
(
    ID          INT(10)      NOT NULL AUTO_INCREMENT PRIMARY KEY,
    USER_ID     INT(10)      NOT NULL,
    CARD_ID     VARCHAR(10)  NOT NULL UNIQUE,
    CARD_NUMBER VARCHAR(200) NOT NULL UNIQUE,
    CVC         SMALLINT(3)  NOT NULL,
    AMOUNT      INT(10)      NOT NULL,
    CURRENCY    VARCHAR(255) NOT NULL
);


ALTER TABLE DEVICE
    ADD FOREIGN KEY (USER_ID) REFERENCES USER (ID);

ALTER TABLE TOKEN
    ADD FOREIGN KEY (USER_ID) REFERENCES USER (ID);

ALTER TABLE BANK_CARD
    ADD FOREIGN KEY (USER_ID) REFERENCES USER (ID);


-- DATA SEEDING

INSERT INTO USER (ID, NAME, EMAIL)
VALUES (1000, 'Teszt Aladár', 'teszt.aladar@otpmobil.com'),
       (2000, 'Teszt Benedek', 'teszt.benedek@otpmobil.com'),
       (3000, 'Teszt Cecília', 'teszt.cecilia@otpmobil.com'),
       (12000, 'Teszt Dömötör', 'teszt.domotor@otpmobil.com'),
       (20000, 'Teszt Erika', 'teszt.erika@otpmobil.com'),
       (5500, 'Űrményi-Vőfély Örs Üllő', 'inkabb.hagyjuk-mi-a-teljes.neve@otpmobil.com');


INSERT INTO DEVICE (USER_ID, DEVICE_HASH)
VALUES (1000, 'F67C2BCBFCFA30FCCB36F72DCA22A817'),
       (1000, '0F1674BD19D3BBDD4C39E14734FFB876'),
       (1000, '3AE5E9658FBD7D4048BD40820B7D227D'),
       (2000, 'FADDFEA562F3C914DCC81956682DB0FC'),
       (3000, 'E68560872BDB2DF2FFE7ADC091755378'),
       (12000, 'LBUW70B0H9ERZZY1PITHOE2U72WU9XYU'),
       (20000, 'DMPAGOLOQZ7JPXWDKMJ3LEWVEV2V316Q'),
       (5500, 'CYPA0VARI2YMWZH0ZZFDGX3FVZFN3TZG');


INSERT INTO TOKEN (USER_ID, TOKEN)
VALUES (1000, 'dGVzenQuYWxhZGFyQG90cG1vYmlsLmNvbSYxMDAwJkY2N0MyQkNCRkNGQTMwRkNDQjM2RjcyRENBMjJBODE3'),
       (2000, 'dGVzenQuYmVuZWRla0BvdHBtb2JpbC5jb20mMjAwMCZGQURERkVBNTYyRjNDOTE0RENDODE5NTY2ODJEQjBGQw=='),
       (3000, 'dGVzenQuY2VjaWxpYUBvdHBtb2JpbC5jb20mMzAwMCZFNjg1NjA4NzJCREIyREYyRkZFN0FEQzA5MTc1NTM3OA=='),
       (1000, 'dGVzenQuYWxhZGFyQG90cG1vYmlsLmNvbSYxMDAwJjBGMTY3NEJEMTlEM0JCREQ0QzM5RTE0NzM0RkZCODc2'),
       (1000, 'dGVzenQuYWxhZGFyQG90cG1vYmlsLmNvbSYxMDAwJjNBRTVFOTY1OEZCRDdENDA0OEJENDA4MjBCN0QyMjdE'),
       (12000, 'dGVzenQuZG9tb3RvckBvdHBtb2JpbC5jb20mMTIwMDAmTEJVVzcwQjBIOUVSWlpZMVBJVEhPRTJVNzJXVTlYWVU='),
       (20000, 'dGVzenQuZXJpa2FAb3RwbW9iaWwuY29tJjIwMDAwJkRNUEFHT0xPUVo3SlBYV0RLTUozTEVXVkVWMlYzMTZR'),
       (5500,
        'aW5rYWJiLmhhZ3lqdWstbWktYS10ZWxqZXMubmV2ZUBvdHBtb2JpbC5jb20mNTUwMCZDWVBBMFZBUkkyWU1XWkgwWlpGREdYM0ZWWkZOM1RaRw==');


INSERT INTO BANK_CARD (USER_ID, CARD_ID, CARD_NUMBER, CVC, AMOUNT, CURRENCY)
VALUES (1000, 'C0001', '5299706965433676', 123, 1000, 'HUF'),
       (2000, 'C0002', '5390508354245119', 456, 2000, 'HUF'),
       (3000, 'C0003', '4929088924014470', 789, 3000, 'HUF'),
       (12000, 'C0004', '3891053918054353', 145, 16000, 'HUF'),
       (20000, 'C0005', '2755799361195543', 956, 22000, 'HUF'),
       (5500, 'C0006', '2675682222828966', 043, 234678, 'HUF');